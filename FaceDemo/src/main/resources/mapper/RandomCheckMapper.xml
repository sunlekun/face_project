<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.demo.dao.RandomCheckDao">

	 <!--  <resultMap id="randomCheck" type="RandomCheck">
        <result property="id" column="id"/>
        <result property="video_id" column="video_id"/>
        <result property="user_id" column="user_id"/>
        <result property="status" column="status"/>
        <result property="add_time" column="add_time"/>
        <result property="is_delete" column="is_delete"/>
        <association property="user" column="user_id" 
        javaType="User" select="getUserById" />
         <association property="videoIdent" column="video_id" 
        javaType="VideoIdent" select="getVideoIdentById" />
    </resultMap>
	
	<select id="getUserById"  resultType="User">
        SELECT * FROM users WHERE id = #{id} 
    </select>
    
    <select id="getVideoIdentById" resultType="VideoIdent">
        SELECT * FROM video_ident WHERE id = #{id} 
    </select>
    
	<select id="findRandomCheckByStatus" resultMap="randomCheck"> 
		   
	select r.* from random_check r  where r.is_delete=0 
		<if test="status != null ">  
          and  status = #{status},  
        </if> 
	</select>
	
	 <select id="findRandomCheckByStatus" resultMap="RandomCheck"> 
		   
	select r.* from random_check r  where r.is_delete=0 
		<if test="status != null ">  
          and  status = #{status},  
        </if> 
	</select>
	  -->
	  
	   <select id="findRandomCheckByStatus" resultType="RandomCheck"> 
		   
	select r.* ,u.user_name as user_name ,u.user_idcard as user_idcard,v.img_url as img_url , v.add_time as vadd_time ,v.year as year  from random_check r 
	   LEFT JOIN users u on u.id=r.user_id
	   LEFT JOIN video_ident  v on v.id=r.video_id
	 where r.is_delete=0   and v.is_delete=0 and u.is_delete=0
		<if test="status != null and  status !='' ">  
       and r.status= #{status}   
        </if> 
	</select>
	
	   <select id="findRandomCheckByVideoStatus" resultType="RandomCheck"> 
		   
	select r.* ,u.user_name as user_name ,u.user_idcard as user_idcard,v.img_url as img_url , v.add_time as vadd_time ,v.year as year  from random_check r 
	   LEFT JOIN users u on u.id=r.user_id
	   LEFT JOIN video_ident  v on v.id=r.video_id
	 where r.is_delete=0   and v.is_delete=0 and u.is_delete=0
		<if test="video_status != null and  video_status !='' ">  
        and v.video_status= #{video_status}   
        </if> 
	</select>
</mapper>